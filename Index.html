<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Putzplan mit 3 Schichten</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background:#e8f5e9; color:#2e7d32; }
    header { display:flex; gap:10px; align-items:center; justify-content:center; font-weight:bold; margin-bottom: 20px;}
    #dateDisplay { font-size: 1.2em; }
    button { background:#2e7d32; color:white; border:none; border-radius:4px; padding:6px 10px; cursor:pointer; }
    button:disabled { background:#a5d6a7; cursor:not-allowed; }
    .shifts { display:flex; gap: 20px; justify-content:center; flex-wrap: wrap; }
    .shift {
      background:#c8e6c9;
      border-radius:8px;
      padding:15px;
      width: 300px;
      box-shadow: 0 2px 5px rgb(46 125 50 / 0.3);
    }
    .shift h2 {
      text-align:center;
      margin-top:0;
      color:#1b5e20;
    }
    .task {
      background:#a5d6a7;
      padding:8px;
      margin-bottom:8px;
      border-radius:4px;
      position:relative;
      word-break: break-word;
    }
    .delete {
      position:absolute;
      right:8px;
      top:8px;
      cursor:pointer;
      font-weight: bold;
      color: #1b5e20;
    }
  </style>
</head>
<body>

<header>
  <button id="prev">◀</button>
  <div id="dateDisplay"></div>
  <button id="next">▶</button>
</header>

<div class="shifts">
  <section class="shift" id="shift-frueh">
    <h2>Frühschicht</h2>
    <div class="tasks"></div>
    <button class="addTaskBtn">+ Aufgabe hinzufügen</button>
  </section>

  <section class="shift" id="shift-tag">
    <h2>Tagesschicht</h2>
    <div class="tasks"></div>
    <button class="addTaskBtn">+ Aufgabe hinzufügen</button>
  </section>

  <section class="shift" id="shift-spaet">
    <h2>Spätschicht</h2>
    <div class="tasks"></div>
    <button class="addTaskBtn">+ Aufgabe hinzufügen</button>
  </section>
</div>

<script>
  let currentDate = new Date();
  currentDate.setHours(0,0,0,0);

  const dateDisplay = document.getElementById('dateDisplay');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');

  const shifts = ['frueh', 'tag', 'spaet'];

  function storageKey(date, shift) {
    // Beispiel: tasks_2025-05-28_frueh
    return `tasks_${date.toISOString().slice(0,10)}_${shift}`;
  }

  function loadTasks() {
    shifts.forEach(shift => {
      const container = document.querySelector(`#shift-${shift} .tasks`);
      container.innerHTML = '';
      const key = storageKey(currentDate, shift);
      const tasks = JSON.parse(localStorage.getItem(key) || '[]');
      tasks.forEach((task, i) => {
        const div = document.createElement('div');
        div.className = 'task';
        div.textContent = task;

        const del = document.createElement('span');
        del.className = 'delete';
        del.textContent = '×';
        del.title = 'Löschen';
        del.onclick = () => {
          tasks.splice(i,1);
          localStorage.setItem(key, JSON.stringify(tasks));
          loadTasks();
        };

        div.appendChild(del);
        container.appendChild(div);
      });
    });
  }

  function saveTask(shift, text) {
    const key = storageKey(currentDate, shift);
    const tasks = JSON.parse(localStorage.getItem(key) || '[]');
    tasks.push(text);
    localStorage.setItem(key, JSON.stringify(tasks));
    loadTasks();
  }

  function updateDateDisplay() {
    dateDisplay.textContent = currentDate.toLocaleDateString('de-DE', { weekday:'long', day:'2-digit', month:'2-digit', year:'numeric' });
  }

  prevBtn.onclick = () => {
    currentDate.setDate(currentDate.getDate() - 1);
    updateDateDisplay();
    loadTasks();
  };

  nextBtn.onclick = () => {
    currentDate.setDate(currentDate.getDate() + 1);
    updateDateDisplay();
    loadTasks();
  };

  document.querySelectorAll('.addTaskBtn').forEach(btn => {
    btn.addEventListener('click', () => {
      const shift = btn.parentElement.id.replace('shift-','');
      const text = prompt(`Neue Aufgabe für ${shift.charAt(0).toUpperCase() + shift.slice(1)}schicht:`);
      if(text && text.trim().length > 0) {
        saveTask(shift, text.trim());
      }
    });
  });

  // Init
  updateDateDisplay();
  loadTasks();
</script>

</body>
</html>
